<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>login for Institution</title>
    <link rel="stylesheet" href="signupd.css">
</head>
<body>    
    <h2>login for Institution</h2><br>    
    <div class="login">    
    <form id="login" method="get" action="login.php">    
        <label><b>Enter Email     
        </b>    
        </label>    
        <input type="text" name="Email" id="Uname" placeholder="Email">    
        <br><br>    
        <label><b>Password     
        </b>    
        </label>    
        <input type="Password" name="Pass" id="Pass" placeholder="Password">    
        <br><br>    
        <input type="button" name="log" id="log" value="Log In Here">       
        <br><br>    
        <input type="checkbox" id="check">    
        <span>Remember me</span>   
        <br><br>  
        <span>Don't Have An Account Create One now <a href="signupd.html">Sign Up</a></span>

    </form>     
</div>    
</body>  

<script type="module">

    // Import the functions you need from the SDKs you need
  
    import { initializeApp } from "https://www.gstatic.com/firebasejs/9.4.0/firebase-app.js";
    import { getDatabase, get, ref, update, set, child, remove } from "https://www.gstatic.com/firebasejs/9.4.0/firebase-database.js";
    import { getAuth, createUserWithEmailAndPassword, signInWithEmailAndPassword } from "https://www.gstatic.com/firebasejs/9.4.0/firebase-auth.js";
  
    // TODO: Add SDKs for Firebase products that you want to use
  
    // https://firebase.google.com/docs/web/setup#available-libraries
  
  
    // Your web app's Firebase configuration
  
    // For Firebase JS SDK v7.20.0 and later, measurementId is optional
  
    //fille the below empty filed with your Credentials
    const firebaseConfig = {
  
  apiKey: "",

  authDomain: "",

  databaseURL: "",

  projectId: "",

  storageBucket: "",

  messagingSenderId: "",

  appId: "",

  measurementId: ""

};
  
  
    // Initialize Firebase
  
    const app = initializeApp(firebaseConfig);
    const database = getDatabase();
    const auth = getAuth();

    log.addEventListener('click', (e)=>{

var email = document.getElementById('Uname').value;
 var password = document.getElementById('Pass').value;

signInWithEmailAndPassword (auth, email, password)
.then((userCredential) => {

// Signed in

const user = userCredential.user;

const dt = new Date(); 
update(ref(database, 'usersdonation/' + user.uid), {

last_login: dt,

})

alert('User loged in!');
window.location.href = "dindex.html";


})

.catch((error) => {

const errorCode = error.code;

const errorMessage = error.message;
alert(errorMessage);

});

});
  
  </script>

</body>

</html>
